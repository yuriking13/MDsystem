# –ê–Ω–∞–ª–∏–∑ –∏ —É–ª—É—á—à–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–π

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±—ç–∫–µ–Ω–¥–∞

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

1. **–£–º–Ω–∞—è –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Å–≤—è–∑–µ–π** - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è–º, —á–∞—Å—Ç–æ—Ç–µ, –≥–æ–¥—É
2. **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–æ—Ä–æ–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è
3. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –≥–æ–¥–∞–º (5-–ª–µ—Ç–Ω–∏–µ –ø–µ—Ä–∏–æ–¥—ã) –∏ –∂—É—Ä–Ω–∞–ª–∞–º
4. **–õ–∏–º–∏—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - maxLinksPerNode, maxExtraNodes
5. **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –≥–ª—É–±–∏–Ω–∞** - level 1 (–ø—Ä–æ–µ–∫—Ç), level 2 (—Å—Å—ã–ª–∫–∏), level 3 (—Ü–∏—Ç–∏—Ä—É—é—â–∏–µ)
6. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** - PubMed, DOAJ, Wiley, Crossref

### –¢–µ–∫—É—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É (selected/excluded/all)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ–¥–∞–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—á–µ—Å—Ç–≤—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (p-value)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É —Å—Ç–∞—Ç—å–∏
- –ü–æ–∏—Å–∫ —Å–≤—è–∑–µ–π —á–µ—Ä–µ–∑ PMIDs –∏ DOIs
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö –≥—Ä–∞—Ñ–æ–≤ (>50 —É–∑–ª–æ–≤)

## üöÄ –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. **AI-–∞–≥–µ–Ω—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π**

#### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPT-4 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–æ–∏—Å–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö —Ä–∞–±–æ—Ç.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```typescript
// POST /api/projects/:projectId/citation-graph/ai-search
// Body: { query: string, context?: string, maxResults?: number }

async function aiSearchRelevantPapers(
  projectContext: {
    title: string;
    articles: { title: string; abstract: string; pmid: string }[];
  },
  userQuery: string,
): Promise<{ pmids: string[]; reasoning: string }> {
  const prompt = `
–ê–Ω–∞–ª–∏–∑–∏—Ä—É—è –ø—Ä–æ–µ–∫—Ç "${projectContext.title}" —Å–æ —Å—Ç–∞—Ç—å—è–º–∏:
${projectContext.articles.map((a) => `- ${a.title} (PMID: ${a.pmid})`).join("\n")}

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—â–µ—Ç: "${userQuery}"

–ü—Ä–µ–¥–ª–æ–∂–∏ 10-20 –∫–ª—é—á–µ–≤—ã—Ö PMIDs —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ:
1. –¶–∏—Ç–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ —Ü–∏—Ç–∏—Ä—É—é—Ç—Å—è –∏–º–∏
2. –ò—Å—Å–ª–µ–¥—É—é—Ç —Å—Ö–æ–∂—É—é –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –∏–ª–∏ —Ç–µ–º–∞—Ç–∏–∫—É
3. –ó–∞–ø–æ–ª–Ω—è—é—Ç –ø—Ä–æ–±–µ–ª—ã –≤ —Ç–µ–∫—É—â–µ–º –≥—Ä–∞—Ñ–µ –∑–Ω–∞–Ω–∏–π

–í–µ—Ä–Ω–∏ JSON: { "pmids": ["12345", ...], "reasoning": "..." }
`;

  const response = await openai.chat.completions.create({
    model: "gpt-4",
    messages: [{ role: "user", content: prompt }],
    temperature: 0.3,
  });

  return JSON.parse(response.choices[0].message.content);
}
```

#### Endpoint

```typescript
fastify.post(
  "/projects/:projectId/citation-graph/ai-search",
  { preHandler: [fastify.authenticate] },
  async (request, reply) => {
    const { query, maxResults = 20 } = request.body;

    // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞
    const projectArticles = await loadProjectArticles(projectId);

    // 2. AI –∞–Ω–∞–ª–∏–∑
    const aiResults = await aiSearchRelevantPapers(
      { title: project.title, articles: projectArticles },
      query,
    );

    // 3. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π
    const articles = await pubmedFetchByPmids(
      aiResults.pmids.slice(0, maxResults),
    );

    return {
      articles,
      reasoning: aiResults.reasoning,
      sources: ["AI recommendation"],
    };
  },
);
```

---

### 2. **–£–º–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (Smart Clustering)**

#### 2.1 –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ embeddings

```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º text-embedding-3-small –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–±—Å—Ç—Ä–∞–∫—Ç–æ–≤
async function semanticClustering(
  articles: { id: string; title: string; abstract: string }[],
): Promise<Cluster[]> {
  // 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º embeddings –¥–ª—è –≤—Å–µ—Ö –∞–±—Å—Ç—Ä–∞–∫—Ç–æ–≤
  const embeddings = await Promise.all(
    articles.map((a) =>
      openai.embeddings.create({
        model: "text-embedding-3-small",
        input: `${a.title}\n${a.abstract}`,
      }),
    ),
  );

  // 2. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ k-means –∏–ª–∏ hierarchical clustering
  const clusters = kMeansClustering(
    embeddings.map((e) => e.data[0].embedding),
    { k: Math.ceil(articles.length / 15) }, // ~15 —Å—Ç–∞—Ç–µ–π –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä
  );

  // 3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ GPT
  for (const cluster of clusters) {
    const titles = cluster.articles.map((a) => a.title).join("\n");
    const clusterName = await generateClusterName(titles);
    cluster.label = clusterName;
  }

  return clusters;
}
```

#### 2.2 –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏

```sql
-- –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É –¥–ª—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ç–µ–≥–æ–≤
ALTER TABLE articles ADD COLUMN methodology_tags TEXT[];

-- AI —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ –∏–∑ –∞–±—Å—Ç—Ä–∞–∫—Ç–∞
-- –¢–µ–≥–∏: "meta-analysis", "RCT", "cohort", "case-control", "systematic-review", etc.
```

```typescript
// –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏
function methodologyClustering(articles: Article[]): Cluster[] {
  const methodGroups = new Map<string, Article[]>();

  for (const article of articles) {
    for (const tag of article.methodology_tags || []) {
      if (!methodGroups.has(tag)) {
        methodGroups.set(tag, []);
      }
      methodGroups.get(tag)!.push(article);
    }
  }

  return Array.from(methodGroups.entries()).map(([method, arts]) => ({
    id: `methodology:${method}`,
    label: `–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è: ${method} (${arts.length})`,
    articles: arts,
    clusterType: "methodology",
  }));
}
```

---

### 3. **–ü–æ–∏—Å–∫ —Å–∫—Ä—ã—Ç—ã—Ö —Å–≤—è–∑–µ–π (Link Prediction)**

#### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å–∏, –∫–æ—Ç–æ—Ä—ã–µ _–¥–æ–ª–∂–Ω—ã_ —Ü–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –Ω–æ –Ω–µ —Ü–∏—Ç–∏—Ä—É—é—Ç (gap analysis).

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ graph embeddings

```typescript
// Node2Vec –∏–ª–∏ GraphSAGE –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —É–∑–ª–æ–≤
async function findMissingLinks(
  graph: { nodes: Node[]; links: Link[] },
  threshold = 0.85, // Cosine similarity
): Promise<SuggestedLink[]> {
  // 1. –û–±—É—á–∞–µ–º Node2Vec –Ω–∞ —Ç–µ–∫—É—â–µ–º –≥—Ä–∞—Ñ–µ
  const embeddings = await node2vec.fit(graph);

  // 2. –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —É–∑–ª–æ–≤ —Å—á–∏—Ç–∞–µ–º similarity
  const suggestions: SuggestedLink[] = [];

  for (let i = 0; i < graph.nodes.length; i++) {
    for (let j = i + 1; j < graph.nodes.length; j++) {
      const sim = cosineSimilarity(embeddings[i], embeddings[j]);

      // –ï—Å–ª–∏ similarity –≤—ã—Å–æ–∫–∏–π, –Ω–æ —Å–≤—è–∑–∏ –Ω–µ—Ç
      const hasLink = graph.links.some(
        (l) =>
          (l.source === i && l.target === j) ||
          (l.source === j && l.target === i),
      );

      if (sim > threshold && !hasLink) {
        suggestions.push({
          source: graph.nodes[i],
          target: graph.nodes[j],
          similarity: sim,
          reasoning: await explainSimilarity(graph.nodes[i], graph.nodes[j]),
        });
      }
    }
  }

  return suggestions.sort((a, b) => b.similarity - a.similarity).slice(0, 50);
}
```

---

### 4. **–ü–æ–∏—Å–∫ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (Context-Aware Search)**

```typescript
// POST /api/projects/:projectId/citation-graph/context-search
// Body: { contextNodes: string[], query: string, radius?: number }

async function contextAwareSearch(
  contextNodes: Node[], // –£–∑–ª—ã-—è–∫–æ—Ä—è
  query: string,
  radius = 2, // –°–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏—Å–∫–∞—Ç—å
): Promise<Node[]> {
  // 1. –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —É–∑–ª—ã –≤ —Ä–∞–¥–∏—É—Å–µ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö
  const neighborhood = expandNeighborhood(contextNodes, radius);

  // 2. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏
  const queryEmbedding = await getEmbedding(query);
  const nodeEmbeddings = await Promise.all(
    neighborhood.map((n) => getEmbedding(`${n.title}\n${n.abstract}`)),
  );

  // 3. –†–∞–Ω–∂–∏—Ä—É–µ–º –ø–æ relevance
  const scored = neighborhood.map((node, i) => ({
    node,
    score: cosineSimilarity(queryEmbedding, nodeEmbeddings[i]),
  }));

  return scored
    .sort((a, b) => b.score - a.score)
    .slice(0, 20)
    .map((s) => s.node);
}
```

---

### 5. **–í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ (Temporal Analysis)**

```typescript
// GET /api/projects/:projectId/citation-graph/timeline
// –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–≤–æ–ª—é—Ü–∏—é —Ç–µ–º–∞—Ç–∏–∫–∏ –ø–æ –≥–æ–¥–∞–º

interface Timeline {
  year: number;
  nodeCount: number;
  topTopics: string[]; // AI-–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ —Ç–µ–º—ã
  keyPapers: Node[]; // –°–∞–º—ã–µ —Ü–∏—Ç–∏—Ä—É–µ–º—ã–µ –∑–∞ –≥–æ–¥
  trends: {
    emerging: string[]; // –ù–æ–≤—ã–µ —Ç–µ–º—ã
    declining: string[]; // –£–≥–∞—Å–∞—é—â–∏–µ —Ç–µ–º—ã
  };
}

async function buildTimeline(graph: Graph): Promise<Timeline[]> {
  const byYear = groupBy(graph.nodes, (n) => n.year);

  const timeline: Timeline[] = [];

  for (const [year, nodes] of Object.entries(byYear)) {
    // AI —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è —Ç–µ–º –¥–ª—è –≥–æ–¥–∞
    const topics = await extractTopics(
      nodes.map((n) => n.abstract).join("\n\n"),
    );

    timeline.push({
      year: parseInt(year),
      nodeCount: nodes.length,
      topTopics: topics.slice(0, 5),
      keyPapers: nodes
        .sort((a, b) => b.citedByCount - a.citedByCount)
        .slice(0, 5),
      trends: await detectTrends(year, topics),
    });
  }

  return timeline.sort((a, b) => a.year - b.year);
}
```

---

### 6. **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

```typescript
// GET /api/projects/:projectId/citation-graph/recommendations
// AI-–∞–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥—Ä–∞—Ñ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è

interface Recommendation {
  type:
    | "missing_citation"
    | "orphan_cluster"
    | "weak_connection"
    | "outdated_paper";
  title: string;
  description: string;
  priority: "high" | "medium" | "low";
  action: {
    type: "add_article" | "fetch_references" | "review";
    payload: any;
  };
}

async function generateRecommendations(
  graph: Graph,
): Promise<Recommendation[]> {
  const recs: Recommendation[] = [];

  // 1. Orphan nodes (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç—å–∏)
  const orphans = graph.nodes.filter(
    (n) =>
      graph.links.filter((l) => l.source === n.id || l.target === n.id)
        .length === 0,
  );

  if (orphans.length > 0) {
    recs.push({
      type: "orphan_cluster",
      title: `${orphans.length} –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π`,
      description: "–°—Ç–∞—Ç—å–∏ –±–µ–∑ —Å–≤—è–∑–µ–π —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º –≥—Ä–∞—Ñ–æ–º",
      priority: "high",
      action: {
        type: "fetch_references",
        payload: { nodeIds: orphans.map((o) => o.id) },
      },
    });
  }

  // 2. –°—Ç–∞—Ä—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Ä–∞–±–æ—Ç—ã –±–µ–∑ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–π
  const outdated = graph.nodes.filter(
    (n) =>
      n.citedByCount > 50 && n.year < 2015 && !hasRecentCitations(n, graph),
  );

  for (const node of outdated) {
    const modernAlternatives = await findModernEquivalents(node);
    recs.push({
      type: "outdated_paper",
      title: `–û–±–Ω–æ–≤–∏—Ç—å "${node.title.slice(0, 50)}..."`,
      description: `–°—Ç–∞—Ç—å—è ${node.year} –≥–æ–¥–∞ - –Ω–∞–π–¥–µ–Ω—ã –±–æ–ª–µ–µ —Å–≤–µ–∂–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã`,
      priority: "medium",
      action: {
        type: "add_article",
        payload: { suggestions: modernAlternatives },
      },
    });
  }

  // 3. –°–ª–∞–±—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏
  const clusters = detectCommunities(graph);
  for (let i = 0; i < clusters.length; i++) {
    for (let j = i + 1; j < clusters.length; j++) {
      const bridgeCount = countBridges(clusters[i], clusters[j], graph);
      if (bridgeCount < 2) {
        recs.push({
          type: "weak_connection",
          title: `–°–ª–∞–±–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ "${clusters[i].label}" –∏ "${clusters[j].label}"`,
          description: `–¢–æ–ª—å–∫–æ ${bridgeCount} —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏`,
          priority: "low",
          action: { type: "review", payload: { clusters: [i, j] } },
        });
      }
    }
  }

  return recs.sort((a, b) => priorityScore(b) - priorityScore(a));
}
```

---

### 7. **–≠–∫—Å–ø–æ—Ä—Ç –∏ —à–∞—Ä–∏–Ω–≥**

```typescript
// GET /api/projects/:projectId/citation-graph/export
// –§–æ—Ä–º–∞—Ç—ã: json, graphml, gexf, cytoscape

async function exportGraph(graph: Graph, format: string): Promise<Buffer> {
  switch (format) {
    case "graphml":
      return toGraphML(graph);
    case "gexf":
      return toGEXF(graph);
    case "cytoscape":
      return toCytoscape(graph);
    case "gephi":
      return toGephi(graph);
    default:
      return Buffer.from(JSON.stringify(graph, null, 2));
  }
}

// POST /api/projects/:projectId/citation-graph/share
// –°–æ–∑–¥–∞—ë—Ç –ø—É–±–ª–∏—á–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –≥—Ä–∞—Ñ (read-only)

async function createShareLink(projectId: string): Promise<string> {
  const shareToken = crypto.randomUUID();

  await pool.query(
    `INSERT INTO graph_shares (project_id, token, expires_at)
     VALUES ($1, $2, NOW() + INTERVAL '30 days')`,
    [projectId, shareToken],
  );

  return `https://mdsystem.app/shared/graph/${shareToken}`;
}
```

---

## üìã –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è (–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è)

### –§–∞–∑–∞ 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã (1-2 –Ω–µ–¥–µ–ª–∏)

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ fullscreen —Ä–µ–∂–∏–º–∞
2. ‚úÖ –ê–∫–∞–¥–µ–º–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω —É–∑–ª–æ–≤
3. üîÑ **–≠–∫—Å–ø–æ—Ä—Ç –≥—Ä–∞—Ñ–∞** (GraphML, JSON) - –ø—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è
4. üîÑ **–£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** (orphan detection, weak links)

### –§–∞–∑–∞ 2: AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (2-3 –Ω–µ–¥–µ–ª–∏)

5. üÜï **AI-–ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π** —á–µ—Ä–µ–∑ GPT-4
6. üÜï **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ embeddings
7. üÜï **Context-aware search** - –ø–æ–∏—Å–∫ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ —É–∑–ª–æ–≤

### –§–∞–∑–∞ 3: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (3-4 –Ω–µ–¥–µ–ª–∏)

8. üÜï **Link prediction** - –ø–æ–∏—Å–∫ —Å–∫—Ä—ã—Ç—ã—Ö —Å–≤—è–∑–µ–π —á–µ—Ä–µ–∑ graph embeddings
9. üÜï **–í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞** - –∞–Ω–∞–ª–∏–∑ —ç–≤–æ–ª—é—Ü–∏–∏ —Ç–µ–º–∞—Ç–∏–∫–∏
10. üÜï **–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π

### –§–∞–∑–∞ 4: –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

11. üÜï **–ü—É–±–ª–∏—á–Ω—ã–π —à–∞—Ä–∏–Ω–≥** –≥—Ä–∞—Ñ–æ–≤
12. üÜï **–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º** - —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üí° –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è AI-–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤
CREATE TABLE article_ai_tags (
  article_id UUID REFERENCES articles(id),
  tag_type VARCHAR(50), -- 'topic', 'methodology', 'cluster'
  tag_value TEXT,
  confidence FLOAT,
  generated_at TIMESTAMPTZ DEFAULT NOW(),
  PRIMARY KEY (article_id, tag_type, tag_value)
);

CREATE INDEX idx_ai_tags_type ON article_ai_tags(tag_type);
CREATE INDEX idx_ai_tags_value ON article_ai_tags(tag_value);

-- –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è embeddings (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫)
CREATE TABLE article_embeddings (
  article_id UUID PRIMARY KEY REFERENCES articles(id),
  embedding vector(1536), -- OpenAI text-embedding-3-small
  model VARCHAR(50) DEFAULT 'text-embedding-3-small',
  generated_at TIMESTAMPTZ DEFAULT NOW()
);

-- pgvector extension –¥–ª—è similarity search
CREATE EXTENSION IF NOT EXISTS vector;
CREATE INDEX idx_embeddings_cosine ON article_embeddings
  USING ivfflat (embedding vector_cosine_ops);

-- –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —à–∞—Ä–∏–Ω–≥–∞
CREATE TABLE graph_shares (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  project_id UUID REFERENCES projects(id),
  token VARCHAR(255) UNIQUE NOT NULL,
  expires_at TIMESTAMPTZ NOT NULL,
  view_count INT DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_graph_shares_token ON graph_shares(token);
```

### –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```json
{
  "dependencies": {
    "@tensorflow/tfjs-node": "^4.x", // –î–ª—è Node2Vec
    "openai": "^4.x", // GPT-4 –∏ embeddings
    "ml-kmeans": "^6.x", // –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
    "graphology": "^0.25.x", // Graph algorithms
    "graphology-layout-forceatlas2": "^0.x", // Layout –∞–ª–≥–æ—Ä–∏—Ç–º—ã
    "pg": "^8.x",
    "pgvector": "^0.2.x" // –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –≤ Postgres
  }
}
```

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π –≥—Ä–∞—Ñ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–π —Å—Ç–∞–Ω–µ—Ç:

1. **–£–º–Ω—ã–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º** - AI –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å—Ç–∞—Ç—å–∏
2. **–í–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–º** - —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å –≥–æ–≤–æ—Ä—è—â–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
3. **–ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–º** - –Ω–∞—Ö–æ–¥–∏—Ç —Å–∫—Ä—ã—Ç—ã–µ —Å–≤—è–∑–∏ –∏ –ø—Ä–æ–±–µ–ª—ã
4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–º** - –ø–æ–∏—Å–∫ —Å —É—á—ë—Ç–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏—è —É–∑–ª–æ–≤
5. **–î–∏–Ω–∞–º–∏—á–Ω—ã–º** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–≤–æ–ª—é—Ü–∏—é —Ç–µ–º–∞—Ç–∏–∫–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
6. **–°–æ—Ü–∏–∞–ª—å–Ω—ã–º** - —ç–∫—Å–ø–æ—Ä—Ç –∏ –ø—É–±–ª–∏—á–Ω—ã–π —à–∞—Ä–∏–Ω–≥

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ**: –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∏–∑ –ø—Ä–æ—Å—Ç–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ **–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∏–π**.
